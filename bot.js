const Discord = require('discord.js');
const client = new Discord.Client();
const prefix = '.'

client.on('ready', () => {
  console.log(`Logged in as ${client.user.tag}!`);
client.user.setGame(`Nothing`,"http://twitch.tv/S-F")
  console.log('')
  console.log('')
  console.log('╔[═════════════════════════════════════════════════════════════════]╗')
  console.log(`[Start] ${new Date()}`);
  console.log('╚[═════════════════════════════════════════════════════════════════]╝')
  console.log('')
  console.log('╔[════════════════════════════════════]╗');
  console.log(`Logged in as * [ " ${client.user.username} " ]`);
  console.log('')
  console.log('Informations :')
  console.log('')
  console.log(`servers! [ " ${client.guilds.size} " ]`);
  console.log(`Users! [ " ${client.users.size} " ]`);
  console.log(`channels! [ " ${client.channels.size} " ]`);
  console.log('╚[════════════════════════════════════]╝')
  console.log('')
  console.log('╔[════════════]╗')
  console.log(' Bot Is Online')
  console.log('╚[════════════]╝')
  console.log('')
  console.log('')
});

client.on('message',message =>{
    var prefix = "-";
    if(message.content.startsWith(prefix + 'top')) {
  message.guild.fetchInvites().then(i =>{
  var invites = [];
   
  i.forEach(inv =>{
    var [invs,i]=[{},null];
     
    if(inv.maxUses){
        invs[inv.code] =+ inv.uses+"/"+inv.maxUses;
    }else{
        invs[inv.code] =+ inv.uses;
    }
        invites.push(`invite: ${inv.url} inviter: ${inv.inviter} \`${invs[inv.code]}\`;`);
   
  });
  var embed = new Discord.RichEmbed()
  .setColor("#000000")
  .setDescription(`${invites.join(`\n`)+'\n\n**By:** '+message.author}`)
  .setThumbnail("https://media.discordapp.net/attachments/477570106755383307/479229377037598720/22713057_151850495552450_709700562_o.jpg?width=201&height=201")
           message.channel.send({ embed: embed });
   
  });
   
    }
  });//t1

client.on('message', message => {
    if (message.content.startsWith("-avatar")) {
        if (message.author.bot) return
        var mentionned = message.mentions.users.first();
    var omar;
      if(mentionned){
          var omar = mentionned;
      } else {
          var omar = message.author;
          
      }
        const embed = new Discord.RichEmbed()
        .setColor("RANDOM")
        .setAuthor('Avatar Link :')
        .setTitle('Click Here')
        .setURL(`${omar.avatarURL}`)
        .setImage(`${omar.avatarURL}`)
        .setFooter('Epic Bot',client.user.avatarURL) 
      message.channel.sendEmbed(embed);
    }
});//t2

client.on('message', message=> {
    if (message.author.bot) return;
    if (message.isMentioned(client.user))
    {
    message.reply(" هلا !!");
    }
});//t3

client.on('message', message => {

    if (message.content === "-lock") {
                        if(!message.channel.guild) return message.reply(' هذا الامر فقط للسيرفرات !!');

if(!message.member.hasPermission('MANAGE_MESSAGES')) return message.reply(' ليس لديك صلاحيات');
           message.channel.overwritePermissions(message.guild.id, {
         SEND_MESSAGES: false

           }).then(() => {
               message.reply("تم تقفيل الشات ✅ ")
           });
             }
if (message.content === "-unlock") {
    if(!message.channel.guild) return message.reply(' هذا الامر فقط للسيرفرات !!');

if(!message.member.hasPermission('MANAGE_MESSAGES')) return message.reply('ليس لديك صلاحيات');
           message.channel.overwritePermissions(message.guild.id, {
         SEND_MESSAGES: true

           }).then(() => {
               message.reply("تم فتح الشات✅")
           });
             }



});//t4

client.on("ready", async () => {
    if(client.users.size > 1) {
        client.user.setActivity(`-help | ${client.users.size} Player`);
        console.log(`${client.user.username} With ${client.users.size} Player`)
    } else {
        client.user.setActivity(`-help | ${client.users.size} Player`);
        console.log(`${client.user.username} -help | ${client.users.size} Player`)
    }
    client.user.setStatus("online");
});

client.on("guildCreate", guild => {
    console.log("Joined a new guild: " + guild.name);
    if(client.users.size > 1) {
        client.user.setActivity(`-help | ${client.users.size} Player`);
    } else {
        client.user.setActivity(`-help | ${client.users.size} Player`);
    }
});

client.on("guildDelete", guild => {
    console.log("Left a guild: " + guild.name);
    if(client.users.size > 1) {
        client.user.setActivity(`-help | ${client.users.size} Player`);
    } else {
        client.user.setActivity(`-help | ${client.users.size} Player`);
    }
});

client.on("message", async () => {
  
})//t5

client.on('message', message => {
    if(message.content.includes('discord.gg')){
                                            if(!message.channel.guild) return message.reply('** advertising me on DM ? 🤔   **');
        if (!message.member.hasPermissions(['ADMINISTRATOR'])){
        message.delete()
    return message.reply(`** No Invite Links :angry: !**`)
    }
}
});//t6

client.on("message", msg => {
  if(msg.content === '-' + "profile") {
      const embed = new Discord.RichEmbed();
  embed.addField("🔱| اسم الحساب :", `${msg.author.username}#${msg.author.discriminator}`, true)
          .addField("🆔| الاي دي :", `${msg.author.id}`, true)
          .setColor("RANDOM")
          .setFooter(msg.author.username , msg.author.avatarURL)
          .setThumbnail(`${msg.author.avatarURL}`)
          .setTimestamp()
          .setURL(`${msg.author.avatarURL}`)
          .addField('📛| الحالة :', `${msg.author.presence.status.toUpperCase()}`, true)
          .addField('🎲| بلاينج :', `${msg.author.presence.game === null ? "No Game" : msg.author.presence.game.name}`, true)
          .addField('🏅| الرتب : ', `${msg.member.roles.filter(r => r.name).size}`, true)
          .addField('📅| تم الانضمام للديسكورد في :', `${msg.createdAt}`,true)
          .addField('🤖| هل هو بوت ؟', `${msg.author.bot.toString().toUpperCase()}`, true);
      msg.channel.send({embed: embed})
  }
});//t7

client.on('message', message => {
    if (message.author.bot) return;
     if (message.content === '-' + "help") {
         if(!message.guild.member(message.author).hasPermission("SEND_MESSAGES")) return message.reply(`
         
         **no permission**
         
         
         `);
         message.channel.send('**لقد تم ارسال رسالة المساعدة في الرسائل الخاصة**');
            
    
         


 message.author.sendMessage(`
 **
╔[❖══════════════════════❖]╗
        الأوامر العامة 
╚[❖══════════════════════❖]╝
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= 
 ❖ -bot ➾ معلومات البوت
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 ❖ -id ➾ الهوية
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 ❖ -top ➾ توب انفايت
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 ❖ -profile < mention > ➾ معلومات الحساب
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= 
 ❖ -avatar < mention > ➾ افاتار الحساب
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= 
 ❖ -count ➾ عدد الأعضاء
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=


╔[❖══════════════════════❖]╗
        أوامر ادارة السيرفر
╚[❖══════════════════════❖]╝
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 ❖ -lock ➾ تقفيل الشات
 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= 
 ❖ -unlock ➾ فتح الشات
 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 ❖ -bc ➾ برودكاست
 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 ❖ -bans ➾ عدد الاشخاص المبندين من السيرفر
 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 ❖ -server ➾ معلومات السيرفر
 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
 ❖ -setvoice ➾ عمل روم عدد الاعضاء في رومات صوتيه
 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
**

`);

    }
});//t8

         client.on('message', message => {
            if (message.content === '-' + "bot") {
     let embed = new Discord.RichEmbed()
.setThumbnail(message.author.avatarURL)
.addField(' السيرفرات🌐',`[${client.guilds.size}]  `)
.addField(' الاعضاء👥 ',` [${client.users.size}] `)
.addField('الرومات📚 ',`[${client.channels.size}]`) 
.addField(' البنق🚀 ',`[${Date.now() - message.createdTimestamp}]`) 
.addField('مصمم  + صاحب البوت ',`Redx#9988`)
.setColor('#7d2dbe')
  message.channel.sendEmbed(embed);
    }
});//t9

client.on('message', message => { 
    var prefix ="-";
           if (message.content.startsWith(prefix + "id")) {
     var args = message.content.split(" ").slice(1);
     let user = message.mentions.users.first();
     var men = message.mentions.users.first();
        var heg;
        if(men) {
            heg = men
        } else {
            heg = message.author
        }
      var mentionned = message.mentions.members.first();
         var h;
        if(mentionned) {
            h = mentionned
        } else {
            h = message.member
        }
               moment.locale('ar-TN');
      var id = new  Discord.RichEmbed()
      .setAuthor(message.author.username, message.author.avatarURL) 
    .setColor("#707070")
    .addField(': دخولك لديسكورد قبل', `${moment(heg.createdTimestamp).format('YYYY/M/D HH:mm:ss')} **\n** \`${moment(heg.createdTimestamp).fromNow()}\`` ,true) 
    .addField(': انضمامك لسيرفر قبل', `${moment(h.joinedAt).format('YYYY/M/D HH:mm:ss')} \n \`${moment(h.joinedAt).fromNow()}\``, true)               
    .setFooter(`Morro Bot`, 'https://images-ext-2.discordapp.net/external/JpyzxW2wMRG2874gSTdNTpC_q9AHl8x8V4SMmtRtlVk/https/orcid.org/sites/default/files/files/ID_symbol_B-W_128x128.gif')                                 
    .setThumbnail(heg.avatarURL);
    message.channel.send(id)
}       });//t10

client.on('message', message => {
              if (!message.channel.guild) return;
      if(message.content =='-count')
      var SaifDz = new Discord.RichEmbed()
      .setThumbnail(message.author.avatarURL)
      .setFooter(message.author.username, message.author.avatarURL)
      .setTitle('🌷| Members info')
      .addBlankField(true)
      .addField('عدد اعضاء السيرفر',`${message.guild.memberCount}`)
      message.channel.send(SaifDz);
    });//t11

client.on("guildMemberAdd", member => {
  member.createDM().then(function (channel) {
  return channel.send(`:rose:  ولكم نورت السيرفر:rose: 
:crown:اسم العضو  ${member}:crown:  
انت العضو رقم ${member.guild.memberCount} `) 
}).catch(console.error)
})//t12

client.on('message', message => {
    if (message.content.startsWith("-bans")) {
        message.guild.fetchBans()
        .then(bans => message.channel.send(`${bans.size} عدد اشخاص المبندة من السيرفر `))
  .catch(console.error);
}
});//t13

client.on('message', message => {
     var prefix ="-"; // هنا تقدر تغيير برفكس البوت
 if(message.content.startsWith(prefix +"server")){
if(!message.channel.guild) return message.reply(' ');
const millis = new Date().getTime() - message.guild.createdAt.getTime();
const now = new Date();
dateFormat(now, 'dddd, mmmm dS, yyyy, h:MM:ss TT');
const verificationLevels = ['None', 'Low', 'Medium', 'Insane', 'Extreme'];
const days = millis / 1000 / 60 / 60 / 24;
let roles = client.guilds.get(message.guild.id).roles.map(r => r.name);
var embed  = new Discord.RichEmbed()
.setAuthor(message.guild.name, message.guild.iconURL)
.addField("🆔 Server ID:", message.guild.id,true)
.addField("📅 Created On", message.guild.createdAt.toLocaleString(),true)
.addField("👑 Owned by",${message.guild.owner.user.username}#${message.guild.owner.user.discriminator})
.addField("👥 Members ",[${message.guild.memberCount}],true)
.addField('💬 Channels ',**${message.guild.channels.filter(m => m.type === 'text').size}** + ' text | Voice  '+ **${message.guild.channels.filter(m => m.type === 'voice').size}**,true)
.addField("🌍 Others " , message.guild.region,true)
.addField(" 🔐 Roles ",**[${message.guild.roles.size}]** Role,true)
.setColor('#000000')
message.channel.sendEmbed(embed)

}
});//t14

client.login(process.env.BOT_TOKEN);
